{"ast":null,"code":"import { createEffect, ofType } from \"@ngrx/effects\";\nimport { createProject, loadProjects, loadProjectsFailure, loadProjectsSuccess, setProject, setProjectSuccess } from \"./project.actions\";\nimport { catchError, of, switchMap, map, tap } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/effects\";\nimport * as i2 from \"../../core/services/project.service\";\nimport * as i3 from \"@ngrx/store\";\nimport * as i4 from \"@angular/material/snack-bar\";\nexport class ProjectEffects {\n  constructor(actions$, projectService, store, _snackBar) {\n    this.actions$ = actions$;\n    this.projectService = projectService;\n    this.store = store;\n    this._snackBar = _snackBar;\n    this.loadProjects$ = createEffect(() => this.actions$.pipe(ofType(loadProjects), switchMap(() => this.projectService.getMyProjects().pipe(map(data => loadProjectsSuccess({\n      data\n    })), catchError(error => of(loadProjectsFailure({\n      error\n    })))))));\n    this.setProject$ = createEffect(() => this.actions$.pipe(ofType(setProject), switchMap(action => this.projectService.getProjectById(action.projectId).pipe(map(data => setProjectSuccess({\n      data\n    })), catchError(error => of(loadProjectsFailure({\n      error\n    })))))));\n    this.setProjectSuccess$ = createEffect(() => this.actions$.pipe(ofType(setProjectSuccess), map(action => {\n      localStorage.setItem('project', JSON.stringify(action.data));\n    })), {\n      dispatch: false\n    });\n    this.createProject$ = createEffect(() => this.actions$.pipe(ofType(createProject), switchMap(action => this.projectService.createProject(action.project).pipe(tap(res => setProject({\n      projectId: res.id\n    })), map(data => {\n      this._snackBar.open('Project updated', 'Close', {\n        duration: 2000\n      });\n      return loadProjects();\n    }), catchError(error => of(loadProjectsFailure({\n      error\n    })))))));\n    this.updateProject$ = createEffect(() => this.actions$.pipe(ofType(createProject), switchMap(action => this.projectService.updateProject(action.project).pipe(tap(res => setProject({\n      projectId: res.id\n    })), map(data => loadProjects()), catchError(error => of(loadProjectsFailure({\n      error\n    })))))));\n  }\n}\nProjectEffects.ɵfac = function ProjectEffects_Factory(t) {\n  return new (t || ProjectEffects)(i0.ɵɵinject(i1.Actions), i0.ɵɵinject(i2.ProjectService), i0.ɵɵinject(i3.Store), i0.ɵɵinject(i4.MatSnackBar));\n};\nProjectEffects.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ProjectEffects,\n  factory: ProjectEffects.ɵfac\n});","map":{"version":3,"mappings":"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","names":["createEffect","ofType","createProject","loadProjects","loadProjectsFailure","loadProjectsSuccess","setProject","setProjectSuccess","catchError","of","switchMap","map","tap","ProjectEffects","constructor","actions$","projectService","store","_snackBar","pipe","getMyProjects","data","error","action","getProjectById","projectId","localStorage","setItem","JSON","stringify","dispatch","project","res","id","open","duration","updateProject","factory"],"sourceRoot":"","sources":["/Users/macbookpro/Desktop/GitHubRepo/Task-Manager-with-NgRx/src/app/store/rxProject/project.effect.ts"],"sourcesContent":["import {Injectable} from \"@angular/core\";\nimport {Actions, createEffect, ofType} from \"@ngrx/effects\";\nimport {ProjectService} from \"../../core/services/project.service\";\nimport {\n    createProject,\n    initCurrentProject, loadProjects, loadProjectsFailure, loadProjectsSuccess, setProject,\n    setProjectSuccess\n} from \"./project.actions\";\nimport {catchError, of, switchMap, map, tap} from \"rxjs\";\nimport {Store} from \"@ngrx/store\";\nimport {ProjectStateModule} from \"./project.reducer\";\nimport {state} from \"@angular/animations\";\n\nimport {IProject} from \"../../core/interfaces/iproject\";\nimport {MatSnackBar} from \"@angular/material/snack-bar\";\n\n\n@Injectable()\nexport class ProjectEffects{\n    constructor(\n        private actions$: Actions,\n        private projectService: ProjectService,\n        private store: Store,\n        private _snackBar: MatSnackBar,\n\n    ) {\n    }\n\n    loadProjects$ = createEffect(() => this.actions$.pipe(\n        ofType(loadProjects),\n        switchMap(() => this.projectService.getMyProjects().pipe(\n            map((data) => loadProjectsSuccess({data})),\n            catchError((error) => of(loadProjectsFailure({error})))\n        ))\n    ))\n\n    setProject$ = createEffect(() => this.actions$.pipe(\n        ofType(setProject),\n        switchMap((action) => this.projectService.getProjectById(action.projectId).pipe(\n            map((data) => setProjectSuccess({data})),\n            catchError((error) => of(loadProjectsFailure({error})))\n        ))\n    ))\n\n    setProjectSuccess$ = createEffect(() => this.actions$.pipe(\n        ofType(setProjectSuccess),\n    map((action) => {\n        localStorage.setItem('project', JSON.stringify(action.data));\n    })\n    ), {dispatch: false});\n\n createProject$ = createEffect(() => this.actions$.pipe(\n        ofType(createProject),\n        switchMap((action) => this.projectService.createProject(action.project).pipe(\n            tap((res: IProject) => setProject({projectId: res.id})),\n            map((data) => {\n                this._snackBar.open('Project updated', 'Close', {\n                        duration: 2000,\n                    }\n                )\n\n              return  loadProjects()\n            }),\n            catchError((error) => of(loadProjectsFailure({error})))\n        ))\n    ))\n\n    updateProject$ = createEffect(() => this.actions$.pipe(\n        ofType(createProject),\n        switchMap((action) => this.projectService.updateProject(action.project).pipe(\n            tap((res: IProject) => setProject({projectId: res.id})),\n            map((data) => loadProjects()),\n            catchError((error) => of(loadProjectsFailure({error})))\n        ))\n    ))\n\n\n\n\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}